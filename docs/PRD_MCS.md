# MCS (Manufacturing CAM Management System) PRD

## 절대 조건 고지
1. 각 단계는 승인 후에만 진행한다.
2. 단계 착수 전 이번 단계 전체 범위를 리뷰하고 오류를 식별한다.
3. 오류 발견 시 수정 전에 승인 재요청한다.
4. 이전 단계 오류가 없음을 재확인한 뒤 다음 단계 승인을 요청한다.
5. 모든 단계 작업은 백그라운드 방식으로 수행한다.
6. 문서/웹뷰어 점검이 필요한 경우 반드시 승인 확인 후 진행한다.
7. Task list 체크박스를 하나씩 업데이트하면서 문서를 업데이트 한다.
8. 모든 작업은 문서로 남긴다.

> 절대 조건은 모든 의사결정과 실행 단계에서 필수 점검 항목이다.

## 1. 프로젝트 한 줄 개요
웹 기반 MCMS 포털과 ESPRIT Edge Add-in을 연동하여 **제조 CAM 데이터(품목, 라우팅, 파일)를 통합 관리**하고, 주니어도 쉽게 사용할 수 있는 트리형 UI를 제공한다.

## 2. 주요 목표
| 구분 | 설명 |
|---|---|
| 데이터 중앙화 | W:\ 공유 드라이브 구조를 유지하면서 메타데이터/이력은 MCMS API로 관리 |
| Add-in 연동 | ESPRIT Add-in 팝업에 필요한 정보(API 키, 라우팅 파라미터)를 웹 포털에서 전달 |
| 사용성 | 주니어 엔지니어도 직관적으로 이해할 수 있는 트리 기반 UI & 온보딩 툴팁 제공 |
| 성능 | 동시 10명 이상 사용 시에도 1초 이내 응답 유지 |
| 확장성 | 향후 머신러닝 추천, 모바일 알림 등 확장 가능한 구조 확보 |

## 3. 사용자 페르소나
- **주니어 CAM 엔지니어**: 라우팅 검토/수정, 승인 진행. 온보딩 안내 필요
- **시니어 프로그래머**: 공정 데이터 등록, Add-in 매개변수 작성
- **생산 관리자**: 승인 이력, KPI 모니터링, 파일 버전 추적
- **ESPIRIT Add-in 운영자**: API 키, ESPRIT 실행 파라미터 관리

## 4. 시스템 아키텍처 개요
`
[Next.js Web 포털]
    |  (REST API)
    v
[MCMS API (.NET 8)] --- [SQL Server]
    |                         |
    | (Queue / REST)          | (파일 메타데이터, 이력)
    v                         v
[MCMS Workers (.NET)]     [W:\ 공유 드라이브]
    |
    | (HTTPS)
    v
[ESPRIT Edge Add-in (C#)]
`

## 5. 기능 정의
| 영역 | 상세 설명 |
|---|---|
| 품목/라우팅 관리 | 품목-Revision-라우팅을 트리 UI로 조회/편집, meta.json 생성/다운로드 |
| ESPRIT 연동 | Add-in이 API 호출로 최신 API 키/파라미터를 수신, 팝업 자동 채움 & 제출 |
| 파일 이력 관리 | W:\ 구조 유지, 파일 체크섬·버전·소유자 정보는 API에서 관리 |
| 승인 워크플로우 | 주니어 작성 → 시니어 검토 → 관리자 승인 → ESPRIT 실행 요청 |
| 온보딩/도움말 | 화면별 툴팁, 도움말 모드, 주니어용 단계별 안내 |
| 모니터링 | 대시보드에서 승인 수, 대기 건수, Add-in 호출 상태 확인 |

## 6. UI 구성 상세
- **상단 헤더**: 검색, 사용자 메뉴, 알림, 도움말 토글
- **좌측 패널**: Tree 구조
  - 아이콘/색상으로 상태 표시 (초안/승인/반려)
  - 품목 → Revision → Routing → 파일 노드 순서
- **우측 메인 패널**
  1. 요약 카드 (CAM Rev, 상태, 마지막 수정자)
  2. 탭 구조
     - 라우팅 세부: 공정 표, 설비/공구 정보
     - 파일 관리: 경로 보기, meta.json 다운로드/업로드
     - 승인 히스토리: 타임라인
     - Add-in 연동: API 키, 팝업 파라미터 입력 & 테스트 버튼
- **ESPIRIT 팝업**
  - 읽기전용 필드(필요 시 수정 가능)
  - “MCMS에서 새 값 불러오기” 버튼으로 최신 데이터 요청

### 디자인 가이드
- 색상: Primary #6FA8DC, Secondary #93C47D, Accent #FFD966
- 폰트: Noto Sans KR (기본 14pt, 헤더 18pt)
- 주니어 친화: 단계별 말풍선, 진행 체크 가이드, 빈 상태 메시지

## 7. 기술 스택
| 계층 | 기술 |
|---|---|
| 프론트엔드 | Next.js 14, React, Ant Design(트리/테이블), React Query |
| 백엔드 | .NET 8 Web API, EF Core, AutoMapper |
| 데이터 | SQL Server (MCMS DB), W:\ 공유 드라이브 (파일) |
| Add-in | ESPRIT Edge C# Add-in (.NET Framework 4.8) |
| 배포 | IIS/Windows Service, CI/CD (Azure DevOps 또는 GitHub Actions) |

## 8. 성능/호환성 요구사항
- 동시 사용자 10명 기준 트리/상세 조회 응답 1초 이내
- API는 JWT 기반 인증, HTTPS 필수
- Add-in은 ESPRIT Edge 2025.1 버전, .NET Framework 4.8 호환
- 브라우저: Chrome/Edge 최신 버전, 해상도 1280px 이상 지원

## 9. 위험 요소 & 대응
| 위험 | 대응 |
|---|---|
| 공유 드라이브 접속 지연 | 파일 접근 비동기 처리, 캐싱 메커니즘 도입 |
| Add-in 인증 실패 | API 키 만료 알림 & 재발급 기능 제공 |
| 사용자 혼란 | 온보딩 가이드, 도움말 모드, 주니어용 매뉴얼 제공 |
| 데이터 무결성 | 승인 워크플로우, 파일 체크섬 검증, 감사 로그 |

## 10. 성공 지표
- 라우팅 승인 리드타임 30% 단축
- Add-in 자동 입력 성공률 95% 이상
- 사용자 만족도 (설문) 80점 이상
- 파일 버전 오류 건수 월 20% 감소


