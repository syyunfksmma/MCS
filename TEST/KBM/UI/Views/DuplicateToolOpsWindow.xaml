<Window x:Class="CAM_API.KBM.UI.Views.DuplicateToolOpsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="중복 공구 사용 공정 정리" SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner">
    <Window.Resources>
        <CollectionViewSource x:Key="cvs" Source="{Binding Items}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="ToolNumber"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- 상단 설명 -->
        <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Margin="0,0,0,8" TextWrapping="Wrap">
            아래 공정이 같은 공구 번호를 중복 사용합니다. 삭제할 공정을 선택하세요.
        </TextBlock>

        <!-- 좌측: ListView -->
        <ListView Grid.Row="1" Grid.Column="0"
                  ItemsSource="{Binding Source={StaticResource cvs}}"
                  MinWidth="560" MinHeight="300"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.CanContentScroll="True"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling">
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="Bold" Margin="0,8,0,4"
                                       Text="{Binding Name, StringFormat=Tool No. {0}}"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListView.GroupStyle>
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="40" Header="">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding IsSelected}" HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="70" Header="Index" DisplayMemberBinding="{Binding Index}"/>
                    <GridViewColumn Width="250" Header="Operation" DisplayMemberBinding="{Binding OperationName}"/>
                    <GridViewColumn Width="120" Header="Tool ID" DisplayMemberBinding="{Binding ToolId}"/>
                    <GridViewColumn Width="80" Header="Tool No." DisplayMemberBinding="{Binding ToolNumber}"/>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- 우측: 버튼(아래 정렬) -->
        <StackPanel Grid.Row="2" Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Right" Margin="12,0,0,0">
            <Button Content="OK"     Width="110" Margin="8" Click="Ok_Click"/>
            <Button Content="Cancel" Width="110" Margin="8" Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>